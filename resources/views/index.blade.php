<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Pneumatiques belhassan</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <meta name="keywords" content="Pneumatiques belhassan,Pneumatiques " />
    <meta name="description" content="Pneumatiques belhassan">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    @include('layouts/header')

    <main class="main">
        <div class="intro-slider slide-animate owl-carousel owl-theme show-nav-hover nav-inside nav-big"
            data-owl-options="{
                'loop': false,
                'dots': false,
                'nav': true
			}">
            <div class="banner intro-slide1"
                style="background: url(//assets/images/demoes/demo42/slider/slide1.jpg) rgb(255, 255, 255);
                min-height: 530px; background-position: right center; background-repeat: no-repeat;">
                <div class="container">
                    <div class="wrapper">
                        <svg class="custom-svg-1" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                            viewBox="0 0 649 578">
                            <path fill="#FFF"
                                d="M-225.5,154.7l358.45,456.96c7.71,9.83,21.92,11.54,31.75,3.84l456.96-358.45c9.83-7.71,11.54-21.92,3.84-31.75
                                    L267.05-231.66c-7.71-9.83-21.92-11.54-31.75-3.84l-456.96,358.45C-231.49,130.66-233.2,144.87-225.5,154.7z">
                            </path>
                            <path class="appear-animate appear-animate-svg" data-animation-name="customLineAnim"
                                data-animation-duration="5000" fill="none" stroke="#222529" stroke-width="1.5"
                                stroke-miterlimit="10" d="M416-21l202.27,292.91c5.42,7.85,3.63,18.59-4.05,24.25L198,603"
                                style="animation-delay: 300ms; animation-duration: 5s;"></path>
                        </svg>
                    </div>
                    <div class="row h-100">
                        <div class="col-md-5 banner-media appear-animate d-none d-md-block"
                            data-animation-name="fadeInRightShorter">
                            <img src="/assets/images/demoes/demo42/banner1.jpg" width="426" height="426"
                                alt="banner" />

                        </div>
                        <div class="col-md-7">
                            <div class="banner-content banner-layer-middle">
                                <div class=" appear-animate" data-animation-name="fadeInLeftShorter"
                                    data-animation-delay="500">
                                    <h2 class="banner-title pb-1">Notre plateforme de vente en ligne vous propose une
                                        multitude de marques, ce qui nous permet d'avoir des prix adaptés à tous les
                                        budgets.</h2>
                                    <div class="banner-action">
                                        <a href="#produits" class="btn btn-primary btn-rounded btn-icon-right"
                                            role="button">Achetez
                                            <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {{-- <div class="banner intro-slide2"
                style="background: url(/assets/images/demoes/demo42/slider/slide2.jpg) rgb(255, 255, 255);
                min-height: 530px; background-position: left center; background-repeat: no-repeat;">
                <div class="container">
                    <div class="wrapper">
                        <svg class="custom-svg-2" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                            viewBox="0 0 649 578">
                            <path fill="#FFF"
                                d="M-225.5,154.7l358.45,456.96c7.71,9.83,21.92,11.54,31.75,3.84l456.96-358.45c9.83-7.71,11.54-21.92,3.84-31.75
                                    L267.05-231.66c-7.71-9.83-21.92-11.54-31.75-3.84l-456.96,358.45C-231.49,130.66-233.2,144.87-225.5,154.7z">
                            </path>
                            <path class="appear-animate appear-animate-svg" data-animation-name="customLineAnim"
                                data-animation-duration="5000" fill="none" stroke="#222529" stroke-width="1.5"
                                stroke-miterlimit="10" d="M416-21l202.27,292.91c5.42,7.85,3.63,18.59-4.05,24.25L198,603"
                                style="animation-delay: 300ms; animation-duration: 5s;"></path>
                        </svg>
                    </div>
                    <div class="row h-100">
                        <div class="col-md-7">
                            <div class="banner-content banner-layer-middle text-right">
                                <div class=" appear-animate" data-animation-name="fadeInRightShorter"
                                    data-animation-delay="500">
                                    <div class="brand-logo px-3 mb-1">
                                        <img src="/assets/images/demoes/demo42/new_brand3_light.png" width="140"
                                            height="60" alt="brand" />
                                    </div>
                                    <h3 class="banner-subtitle pt-1 mb-1">Économisez jusqu'à 30 % </h3>
                                    <h2 class="banner-title pb-1">Kit de freinage haute performance
                                    </h2>



                                    <ul class="info-list mr-0">
                                        <li><i class="far fa-check-circle"></i>
                                            <div class="porto-info-list-item-desc">Meilleure dissipation de la chaleur

                                            </div>
                                        </li>
                                        <li><i class="far fa-check-circle"></i>
                                            <div class="porto-info-list-item-desc">Kit boulonné complet

                                            </div>
                                        </li>
                                        <li><i class="far fa-check-circle"></i>
                                            <div class="porto-info-list-item-desc">
                                                Fabriqué aux Etats-Unis
                                            </div>
                                        </li>
                                    </ul>

                                    <div class="banner-action">
                                        <a href="#produits" class="btn btn-primary btn-rounded btn-icon-right"
                                            role="button">Boutique
                                            Maintenant
                                            <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-5 banner-media appear-animate d-none d-md-block"
                            data-animation-name="fadeInLeftShorter">
                            <img src="/assets/images/demoes/demo42/banner2.jpg" width="504" height="347"
                                alt="banner" />
                            <div class="mark-deal"><i>%
                                </i></div>
                        </div>

                    </div>
                </div>
            </div> --}}
        </div>



        <section class="search-section" style="background-color: #f4f4f4;">
            <div class="container">
                <div class="row justify-content-center">

                    <div class="col-sm-12 col-md-4">
                        <h2 class="search-title p-2 mr-4"><i class="icon-business-book"></i>TROUVEZ VOTRE PRODUIT:</h2>
                    </div>

                    <div class="col-sm-12 col-md-3">
                        <input class="form-control mb-0" type="txt" id="search-input" placeholder="Recherche..." >
                    </div>


                    <div class="col-sm-12 col-md-4">
                        <div class="select-custom">
                            <select class="form-control mb-0" name="search_categorie" id="select1">
                                <option @isset($category) disabled @endisset>
                                    @isset($category)
                                        {{ $category->name }}
                                    @else
                                        Par Categories
                                    @endisset
                                </option>
                                @empty($category->id)
                                    <?php $category_id = 0; ?>
                                    @else
                                    <?php $category_id = $category->id; ?>
                                @endempty

                                @foreach ($categorys as $category1)
                                    <option value="{{ $category1->id }}"
                                        @if ($category_id == $category1->id) selected @endif>
                                        {{ $category1->name }}</option>
                                @endforeach
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-1 icon-container">
                        <a href="/" ><i  class="fa-solid fa-filter-circle-xmark .icon-class"></i></a>
                    </div>
                </div>

            </div>
        </section>
        <script>
            $('#select1').trigger('change');

            $("#select1")
                .on("change", function() {
                    var str = "";
                    $("select option:selected").each(function() {
                        str += $(this).val() + " ";
                        window.location = '/product/search/' + str;
                    });

                });
        </script>
        <div class="container" id="produits">
            <h2 class="title title-underline pb-1 appear-animate mt-3" data-animation-name="fadeInLeftShorter">Produits</h2>

            <nav class="toolbox sticky-header horizontal-filter mb-1" data-sticky-options="{'mobile': true}">
                <div class="toolbox-left">


                    <div class="toolbox-item filter-toggle  d-lg-flex ">
                        <span>Filters:</span>
                        <a href=#>&nbsp;</a>
                    </div>
                </div>
                <!-- End .toolbox-left -->


            </nav>

            <div class="row main-content-wrap">
                <div class="col-lg-9 main-content" id="results-container">
                    <div class="row" >

                        @foreach ($products as $key => $product)
                            <?php $product_image = explode(',', $product->image);
                            $product_image = htmlspecialchars($product_image[0]); ?>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="product-default">
                                    <figure class="preview_product_1"
                                        style="background-image: url('https://belhassan.brosstock.com/public/images/product/{{ $product_image }}');}">
                                        <a href="{{ url('product/' . $product->id) }}">
                                        </a>
                                    </figure>

                                    <div class="product-details">
                                        <div class="category-wrap">
                                            <div class="category-list">
                                                <a href=""
                                                    class="product-category">{{ $product->category->name }}</a>
                                            </div>
                                        </div>

                                        <h3 class="product-title">
                                            <a href="{{ url('product/' . $product->id) }}">{{ $product->name }}</a>
                                        </h3>

                                        <div class="ratings-container">
                                            <div class="product-ratings">
                                                <span class="ratings"
                                                    style="width:{{ $product->ratings_percentage }}"></span>
                                                <!-- Assuming $product->ratings_percentage contains the percentage of ratings -->
                                                <span class="tooltiptext tooltip-top"></span>
                                            </div>
                                        </div>

                                        <div class="price-box">

                                            <span class="product-price">{{ $product->price }}Dh</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        @endforeach
                        <!-- End .col-sm-4 -->
                    </div>
                    {{ $products->links() }}
                    <!-- End .row -->
                </div>
                <!-- End .col-lg-9 -->

                <div class="sidebar-overlay"></div>
                <aside class="sidebar-shop col-lg-3 order-lg-first mobile-sidebar">
                    <div class="sidebar-wrapper">
                        <div class="widget">
                            <h3 class="widget-title">
                                @isset($category)

                                    @empty(!$category->parent_id)
                                        <a href="{{route('product.searchByCategorie', $category->parent_id)}}"> <span> < </span> {{ $category->name }}</a>
                                        @else
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true"
                                        aria-controls="widget-body-2">{{ $category->name }}</a>
                                    @endempty

                                    @else
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true"
                                            aria-controls="widget-body-2">Categories</a>
                                @endisset
                            </h3>

                            <div class="collapse show" id="widget-body-2">
                                <div class="widget-body">
                                    <ul class="cat-list cat_list_scroll">
                                        @foreach ($categorys as $category)
                                            <li>
                                                <a href="{{ route('product.searchByCategorie', $category->id) }}"
                                                    aria-expanded="true" aria-controls="widget-category-1">
                                                    {{ $category->name }} <span class="products-count"></span>

                                                </a>

                                            </li>
                                        @endforeach

                                    </ul>
                                </div>
                                <!-- End .widget-body -->
                            </div>
                            <!-- End .collapse -->
                        </div>
                        <!-- End .widget -->

                    </div>
                    <!-- End .sidebar-wrapper -->
                </aside>
                <!-- End .col-lg-3 -->
            </div>
            <!-- End .row -->
        </div>
    </main>
    <script>
        // console.log('here');

        $(document).ready(function(){ // ensure that the page is loaded correctly

            $('#search-input').on('keyup', function(){

                $text = $(this).val();
                $text = $text.trim(); //clear iynput from white spacees ..

                // if ($text == '')
                //     return;

                var category_id = {!! json_encode($category->parent_id) !!};
                $.ajax({
                    url: "{{ route('search') }}",
                    method: 'GET',
                    data: {
                        searchText: $text,
                        idParentCategorie: category_id !== null ? category_id : null

                    },
                    success: function(response) {
                        var resultsContainer = $('#results-container');

                        resultsContainer.empty();

                        resultsContainer.append(resultsContainer.html(response));

                    },
                    error: function(xhr, status, error){
                        console.log('here');
                        console.error('Error', error);
                    }
                });

                $(document).on('click', '.page-link', function (event) {
                        var category_id = {!! json_encode($category->parent_id) !!};
                        event.preventDefault();

                        var page = $(this).attr('href');
                        var searchText = $('#search-input').val();

                        var category_id = {!! json_encode($category->parent_id) !!};
                        $.ajax({
                            url: page,
                            method: 'GET',
                            data:  {
                                searchText: $text,
                                idParentCategorie: category_id !== null ? category_id : null
                            },
                            success: function(response) {
                                var resultsContainer = $('#results-container');

                                resultsContainer.empty();

                                resultsContainer.append(resultsContainer.html(response));

                            },
                            error: function(xhr, status, error){
                                console.log('here');
                                console.error('Error', error);
                            }
                        });

                });



            });



       });



    </script>
    <!-- End .main -->
    @include('layouts/footer')


</html>
